{"version":3,"file":"static/webpack/static\\development\\pages\\creates\\newCand.js.d8c937d720731a9f5a25.hot-update.js","sources":["webpack:///./src/components/candidate/CreateCandidate.jsx"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport { Mutation, Query } from \"react-apollo\";\r\nimport Form from \"../styles/Form\";\r\nimport Error from \"../ErrorMessage.js\";\r\nimport Router from \"next/router\";\r\nimport styled from \"styled-components\";\r\nimport { getAllGendersQuery } from \"../queries&Mutations&Functions/Queries\";\r\nimport { createCandidateMutation } from \"../queries&Mutations&Functions/Mutations\";\r\nimport { uniqueCodeGen,getSelectedObject } from \"../queries&Mutations&Functions/Functions\";\r\n\r\nconst CreateCandForm = styled.div`\r\n  display: grid;\r\n  grid-template-columns: 5fr 7fr;\r\n  grid-gap: 10px;\r\n  min-width: 60vw;\r\n`;\r\nconst PicFrame = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  img {\r\n    height: 20rem;\r\n    width: 20rem;\r\n    border-radius: 15px;\r\n    background-size: contain;\r\n    background-position: center;\r\n  }\r\n`;\r\nconst DataFrame = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nclass CreateCandidate extends Component {\r\n  state = {\r\n    cand1stName: \"\",\r\n    cand2ndName: \"\",\r\n    cand3rdName: \"\",\r\n    email: \"\",\r\n    image: \"\",\r\n    phoneNumb: \"\",\r\n    placeOfBirth: \"\",\r\n    genderID: \"1254\",\r\n    gender: \"\"\r\n  };\r\n\r\n  handleChange = e => {\r\n    const { name, value, type } = e.target;\r\n    const val = type === \"number\" ? parseInt(value) : value;\r\n    this.setState({ [name]: val });\r\n  };\r\n\r\n  resetForm() {\r\n    this.setState({\r\n      cand1stName: \"\",\r\n      cand2ndName: \"\",\r\n      cand3rdName: \"\",\r\n      email: \"\",\r\n      image: \"\",\r\n      phoneNumb: \"\",\r\n      placeOfBirth: \"\"\r\n    });\r\n  }\r\n\r\n  uploadFile = async e => {\r\n    const files = e.target.files;\r\n    const data = new FormData();\r\n    data.append(\"file\", files[0]);\r\n    data.append(\"upload_preset\", \"ineximages\");\r\n    const res = await fetch(\"https://api.cloudinary.com/v1_1/inex/image/upload\", {\r\n      method: \"POST\",\r\n      body: data\r\n    });\r\n    const file = await res.json();\r\n    console.log(file);\r\n    this.setState({\r\n      image: file.secure_url\r\n      // biggerPhoto: <file className=\"e\"></file>ager[0].secure_url,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const { genderID, cand1stName, cand2ndName, cand3rdName, email, image, phoneNumb, placeOfBirth } = this.state;\r\n    return (\r\n      <Query query={getAllGendersQuery}>\r\n        {({ data, loading, error }) => {\r\n          {\r\n            loading && <p>Loading...</p>;\r\n          }\r\n          {\r\n            error && <Error error={error} />;\r\n          }\r\n          const { genders } = data;\r\n\r\n          const allGenders =\r\n            genders &&\r\n            genders.map(item => (\r\n              <option value={item.id} key={item.id}>\r\n                {item.genderName}\r\n              </option>\r\n            ));\r\n\r\n          //*******important function'stripping off __typename')\r\n          const refinedGender = genders && genders.map(({ __typename, ...others }) => others);\r\n          return (\r\n            <Mutation\r\n              mutation={createCandidateMutation}\r\n              variables={{\r\n                ...this.state,\r\n                gender: genders && getSelectedObject(refinedGender, genderID),\r\n                candCode: uniqueCodeGen(12)\r\n              }}\r\n            >\r\n              {(createCandidate, { loading, error }) => (\r\n                <Form\r\n                  onSubmit={async e => {\r\n                    e.preventDefault();\r\n                    const res = await createCandidate();\r\n                    console.log(res);\r\n                    Router.push({\r\n                      pathname: \"/show/singleCand\",\r\n                      query: {\r\n                        id: res.data.createCandidate.id\r\n                      }\r\n                    });\r\n                    this.resetForm();\r\n                  }}\r\n                >\r\n                  <h5>New Candidate</h5>\r\n                  <Error error={error} />\r\n                  <fieldset disabled={loading} aria-busy={loading}>\r\n                    <CreateCandForm>\r\n                      <PicFrame>\r\n                        <input\r\n                          type=\"file\"\r\n                          id=\"file\"\r\n                          name=\"file\"\r\n                          placeholder=\" telechargez photo\"\r\n                          onChange={this.uploadFile}\r\n                          required\r\n                        />\r\n                        <div>{this.state.image && <img src={image} alt=\"Upload image\" />}</div>\r\n                      </PicFrame>\r\n                      <DataFrame>\r\n                        <select\r\n                          type=\"select\"\r\n                          id=\"genderID\"\r\n                          name=\"genderID\"\r\n                          value={genderID}\r\n                          onChange={this.handleChange}\r\n                          required\r\n                        >\r\n                          <option>Choisissez le Sexe</option>\r\n                          {allGenders}\r\n                        </select>\r\n                        <input\r\n                          type=\"text\"\r\n                          id=\"cand1stName\"\r\n                          name=\"cand1stName\"\r\n                          placeholder=\"Nom\"\r\n                          value={cand1stName}\r\n                          onChange={this.handleChange}\r\n                          required\r\n                        />\r\n                        <input\r\n                          type=\"text\"\r\n                          id=\"cand2ndName\"\r\n                          name=\"cand2ndName\"\r\n                          placeholder=\"Prenoms\"\r\n                          value={cand2ndName}\r\n                          onChange={this.handleChange}\r\n                          required\r\n                        />\r\n                        <input\r\n                          type=\"text\"\r\n                          id=\"cand3rdName\"\r\n                          name=\"cand3rdName\"\r\n                          placeholder=\"Autres noms\"\r\n                          value={cand3rdName}\r\n                          onChange={this.handleChange}\r\n                          required\r\n                        />\r\n                        <input\r\n                          type=\"email\"\r\n                          id=\"email\"\r\n                          name=\"email\"\r\n                          placeholder=\"Email\"\r\n                          value={email}\r\n                          onChange={this.handleChange}\r\n                          required\r\n                        />\r\n                        <input\r\n                          type=\"number\"\r\n                          id=\"phoneNumb\"\r\n                          name=\"phoneNumb\"\r\n                          placeholder=\"No Tel\"\r\n                          value={phoneNumb}\r\n                          onChange={this.handleChange}\r\n                          required\r\n                        />\r\n                        <input\r\n                          type=\"text\"\r\n                          id=\"placeOfBirth\"\r\n                          name=\"placeOfBirth\"\r\n                          placeholder=\"Lieu Naissance\"\r\n                          value={placeOfBirth}\r\n                          onChange={this.handleChange}\r\n                          required\r\n                        />\r\n                        <div className=\"submitButton\">\r\n                          <button type=\"submit\">Valid{loading ? \"ation en cours\" : \"er\"}</button>\r\n                        </div>\r\n                      </DataFrame>\r\n                    </CreateCandForm>\r\n                  </fieldset>\r\n                </Form>\r\n              )}\r\n            </Mutation>\r\n          );\r\n        }}\r\n      </Query>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CreateCandidate;\r\nexport { createCandidateMutation };\r\n"],"mappings":"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","sourceRoot":""}