{"version":3,"file":"static/webpack/static\\development\\pages\\newSubDivision.js.8216b43a7ba64823f726.hot-update.js","sources":["webpack:///./src/components/CreateSubDivision.jsx"],"sourcesContent":["import React, { Component } from 'react';\r\nimport { Mutation, Query } from 'react-apollo';\r\nimport Form from './styles/Form';\r\nimport gql from 'graphql-tag';\r\nimport Error from './ErrorMessage';\r\nimport styled from 'styled-components';\r\nimport { storeRegion, storedDivision } from '../data';\r\nimport { select, option } from '@material-ui/core';\r\n\r\nconst StyledDivision = styled.div`\r\n\tdisplay: block;\r\n\ttext-align: center;\r\n\tmargin: 0 auto;\r\n\tmin-width: 350px;\r\n`;\r\n\r\nconst GET_ALL_REGIONS_QUERY = gql`\r\n\tquery GET_ALL_REGIONS_QUERY {\r\n\t\tregions(orderBy: regName_DESC) {\r\n\t\t\tid\r\n\t\t\tregName\r\n\t\t\tregCode\r\n\t\t}\r\n\t}\r\n`;\r\nconst GET_ALL_DIVISIONS_QUERY = gql`\r\n\tquery GET_ALL_DIVISIONS_QUERY {\r\n\t\tdivisions(orderBy: divName_ASC) {\r\n\t\t\tid\r\n\t\t\tdivName\r\n\t\t\tdivCode\r\n\t\t}\r\n\t}\r\n`;\r\nconst GET_DIVISIONS_OF_A_REGION_QUERY = gql`\r\n\tquery GET_DIVISIONS_OF_A_REGION_QUERY($id: ID!) {\r\n\t\tregion(id: $id) {\r\n\t\t\tid\r\n\t\t\tregName\r\n\t\t\tdivision(orderBy: divName_ASC) {\r\n\t\t\t\tid\r\n\t\t\t\tdivName\r\n\t\t\t\tdivCode\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`;\r\nconst CREATE_SUBDIVISION_MUTATION = gql`\r\n\tmutation CREATE_SUBDIVISION_MUTATION(\r\n\t\t$subDivName: String!\r\n\t\t$subDivCode: String!\r\n\t\t$division: DivisionWhereUniqueInput!\r\n\t) {\r\n\t\tcreateSubDivision(subDivName: $subDivName, subDivCode: $subDivCode, division: $division) {\r\n\t\t\tid\r\n\t\t\tsubDivName\r\n\t\t\tsubDivCode\r\n\t\t\tdivision {\r\n\t\t\t\tdivName\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nclass CreateSubDivision extends Component {\r\n\tstate = {\r\n\t\tsubDivName: '',\r\n\t\tsubDivCode: '',\r\n\t\tdivisionID: '12',\r\n\t\tregionID: '12',\r\n\t\tregion: storeRegion,\r\n\t\tdivision: storedDivision\r\n\t};\r\n\r\n\thandleChange = (e) => {\r\n\t\tconst { name, value, type } = e.target;\r\n\t\tconst val = type === 'number' ? parseInt(value) : value;\r\n\t\tthis.setState({ [name]: val });\r\n\t};\r\n\r\n\tgetselectedDivision = (dataSource) => {\r\n\t\t// 1 copy the data source\r\n\t\tif (dataSource.length > 0) {\r\n\t\t\tconst tempDivisions = [ ...dataSource ];\r\n\t\t\t// get the selected division object\r\n\t\t\tconst selectedDivision = tempDivisions.find((item) => item.id === this.state.divisionID);\r\n\t\t\tconsole.log(selectedDivision);\r\n\t\t\treturn selectedDivision;\r\n\t\t}\r\n\t};\r\n\r\n\tgetselectedRegion = (dataSource) => {\r\n\t\t// 1 copy the data source\r\n\t\tif (dataSource.length > 0) {\r\n\t\t\tconst tempRegions = [ ...dataSource ];\r\n\t\t\t// get the selected region object\r\n\t\t\tconst selectedRegion = tempRegions.find((item) => item.id === this.state.regionID);\r\n\t\t\tconsole.log('getting selected region');\r\n\t\t\tconsole.log(selectedRegion);\r\n\t\t\treturn selectedRegion;\r\n\t\t}\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Query query={GET_ALL_REGIONS_QUERY}>\r\n\t\t\t\t{({ data, loading, error }) => {\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tloading && <p>Loading...</p>;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\terror && <Error error={error} />;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst { regions } = data;\r\n\t\t\t\t\tconst anyRegion = regions[0];\r\n\t\t\t\t\tconsole.log('this is any chosen region');\r\n\t\t\t\t\tconsole.log(anyRegion);\r\n\r\n\t\t\t\t\t//prepare data for the region select options\r\n\t\t\t\t\tconst regionsOptions = regions.map((item) => (\r\n\t\t\t\t\t\t<option value={item.id} key={item.id}>\r\n\t\t\t\t\t\t\t{item.regName}-{item.regCode}\r\n\t\t\t\t\t\t</option>\r\n\t\t\t\t\t));\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Query\r\n\t\t\t\t\t\t\tquery={GET_DIVISIONS_OF_A_REGION_QUERY}\r\n\t\t\t\t\t\t\tvariables={this.getselectedRegion(regions) || anyRegion}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{({ data, loading, error }) => {\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tloading && <p>Loading...</p>;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\terror && <Error error={error} />;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tconsole.log('these are the divisions of the selected region');\r\n\t\t\t\t\t\t\t\tconsole.log(data.region.division);\r\n\t\t\t\t\t\t\t\tconst divisionsOptions = data.region.division.map((item) => (\r\n\t\t\t\t\t\t\t\t\t<option value={item.id} key={item.id}>\r\n\t\t\t\t\t\t\t\t\t\t{item.divName}\r\n\t\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t\t));\r\n\t\t\t\t\t\t\t\t//*******important function'stripping off __typename')\r\n\t\t\t\t\t\t\t\tconst divisionsOfARegion = data.region.division.map(\r\n\t\t\t\t\t\t\t\t\t({ divName, divCode, __typename, ...others }) => others\r\n\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<Mutation\r\n\t\t\t\t\t\t\t\t\t\tmutation={CREATE_SUBDIVISION_MUTATION}\r\n\t\t\t\t\t\t\t\t\t\tvariables={{\r\n\t\t\t\t\t\t\t\t\t\t\t...this.state,\r\n\t\t\t\t\t\t\t\t\t\t\tdivision: this.getselectedDivision(divisionsOfARegion)\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{(createSubDivision, { loading, error }) => (\r\n\t\t\t\t\t\t\t\t\t\t\t<StyledDivision>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Form\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonSubmit={async (e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst res = await createSubDivision();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(this.state);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<h5>New Sub-Division</h5>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Error error={error} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<fieldset disabled={loading} aria-busy={loading}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"select\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"regionID\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"regionID\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={this.state.regionID}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option>Choisissez une region</option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   {regionsOptions}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"select\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"divisionID\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"divisionID\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={this.state.divisionID}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option>Choisissez un departement</option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{divisionsOptions}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"subDivName\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"subDivName\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Nom Arrondissement\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={this.state.subDivName}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"subDivCode\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"subDivCode\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Code Arrondissement\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={this.state.subDivCode}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"submitButton\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button type=\"submit\">Submit{loading ? 'ting' : ''}</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</fieldset>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t\t\t\t\t\t\t</StyledDivision>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</Mutation>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t</Query>\r\n\t\t\t\t\t);\r\n\t\t\t\t}}\r\n\t\t\t</Query>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default CreateSubDivision;\r\nexport { GET_ALL_DIVISIONS_QUERY };\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAOA;AASA;AASA;AAaA;AACA;AAgBA;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AACA;AAQA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AANA;AAQA;AACA;AACA;AACA;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAKA;AAEA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AACA;AAKA;AACA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAGA;AAEA;AACA;AAEA;AAFA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAEA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAtDA;AA8DA;AAGA;AAGA;;;;AAjKA;AACA;AAmKA;;;;;A","sourceRoot":""}